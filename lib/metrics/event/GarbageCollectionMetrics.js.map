{"version":3,"sources":["../../../src/metrics/event/GarbageCollectionMetrics.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,IAAM,gBAAgB;AACpB,SAAO,CAAP;AACA,SAAO,CAAP;CAFI;;IAKe;;;AACnB,WADmB,wBACnB,GAAc;wCADK,0BACL;;6FADK,sCACL;;AAEZ,UAAK,IAAL,GAAY,IAAZ,CAFY;AAGZ,UAAK,KAAL,GAAa,aAAb,CAHY;AAIZ,UAAK,MAAL,GAJY;;GAAd;;6BADmB;;6BAQV;;;AACP,2BAAS,EAAT,CAAY,IAAZ,EAAkB,gBAAQ;AACxB,eAAK,KAAL,GAAa,OAAK,SAAL,CAAe,IAAf,CAAb,CADwB;OAAR,CAAlB,CADO;;;;+BAME;AACT,UAAM,mCAAa,KAAK,KAAL,CAAb,CADG;AAET,WAAK,KAAL,GAAa,aAAb,CAFS;AAGT,aAAO,KAAP,CAHS;;;;8BAMD,MAAM;AACd,aAAO;AACL,eAAO,KAAK,IAAL,KAAc,UAAd,GAA2B,KAAK,QAAL,GAAgB,CAA3C;AACP,eAAO,KAAK,IAAL,KAAc,kBAAd,GAAmC,KAAK,QAAL,GAAgB,CAAnD;OAFT,CADc;;;SApBG","file":"GarbageCollectionMetrics.js","sourcesContent":["import profiler from 'gc-profiler';\nimport Metrics from '../Metrics';\n\nconst DEFAULT_VALUE = {\n  minor: 0,\n  major: 0\n};\n\nexport default class GarbageCollectionMetrics extends Metrics {\n  constructor() {\n    super();\n    this.name = 'gc';\n    this.value = DEFAULT_VALUE;\n    this.listen();\n  }\n\n  listen() {\n    profiler.on('gc', info => {\n      this.value = this.toMetrics(info);\n    });\n  }\n\n  getValue() {\n    const value = { ...this.value };\n    this.value = DEFAULT_VALUE;\n    return value;\n  }\n\n  toMetrics(info) {\n    return {\n      minor: info.type === 'Scavenge' ? info.duration : 0,\n      major: info.type === 'MarkSweepCompact' ? info.duration : 0\n    };\n  }\n}\n"]}