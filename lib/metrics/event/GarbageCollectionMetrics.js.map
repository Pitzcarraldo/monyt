{"version":3,"sources":["../../../src/metrics/event/GarbageCollectionMetrics.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAGqB;;;AACnB,WADmB,wBACnB,GAAc;wCADK,0BACL;;6FADK,sCACL;;AAEZ,UAAK,EAAL,GAAU,wBAAV,CAFY;AAGZ,UAAK,IAAL,GAAY,IAAZ,CAHY;AAIZ,UAAK,KAAL,GAAa,EAAb,CAJY;AAKZ,UAAK,MAAL,GALY;;GAAd;;6BADmB;;6BASV;;;AACP,WAAK,EAAL,CAAQ,EAAR,CAAW,OAAX,EAAoB,iBAAS;AAC3B,eAAK,KAAL,GAAc,OAAK,SAAL,CAAe,KAAf,CAAd,CAD2B;OAAT,CAApB,CADO;;;;+BAME;AACT,UAAM,mCAAa,KAAK,KAAL,CAAb,CADG;AAET,WAAK,KAAL,GAAa,EAAb,CAFS;AAGT,aAAO,KAAP,CAHS;;;;8BAMD,OAAO;AACf,UAAM,UAAU,EAAV,CADS;AAEf,UAAM,SAAS,KAAK,SAAL,CAAe,MAAM,MAAN,CAAxB,CAFS;AAGf,UAAM,MAAS,KAAK,IAAL,SAAa,MAAtB,CAHS;AAIf,cAAQ,GAAR,IAAe,MAAM,OAAN,CAJA;AAKf,aAAO,OAAP,CALe;;;;8BAQP,MAAM;AACd,cAAQ,IAAR;AACE,aAAK,CAAL;AACE,iBAAO,OAAP,CADF;AADF,aAGO,CAAL,CAHF;AAIE,aAAK,CAAL;AACE,iBAAO,OAAP,CADF;AAJF;AAOI,iBAAO,EAAP,CADF;AANF,OADc;;;SA7BG","file":"GarbageCollectionMetrics.js","sourcesContent":["import gc from 'gc-stats';\nimport Metrics from '../Metrics';\n\nexport default class GarbageCollectionMetrics extends Metrics {\n  constructor() {\n    super();\n    this.gc = (gc)();\n    this.name = 'gc';\n    this.value = {};\n    this.listen();\n  }\n\n  listen() {\n    this.gc.on('stats', stats => {\n      this.value = (this.toMetrics(stats));\n    });\n  }\n\n  getValue() {\n    const value = { ...this.value };\n    this.value = {};\n    return value;\n  }\n\n  toMetrics(stats) {\n    const metrics = {};\n    const gcType = this.getGCType(stats.gctype);\n    const key = `${this.name}.${gcType}`;\n    metrics[key] = stats.pauseMS;\n    return metrics;\n  }\n\n  getGCType(type) {\n    switch (type) {\n      case 1 :\n        return 'minor';\n      case 2 :\n      case 3 :\n        return 'major';\n      default :\n        return '';\n    }\n  }\n}\n"]}